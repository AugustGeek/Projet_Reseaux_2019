root@VM1-6:/mnt/partage# ./test_iftun 123 | hexdump -C
Ecoute sur le port 123
le n° de la socket est : 3
Option(s) OK!
bind!
listen!
accept! (4) ip=172.16.2.151 port=43450
[172.16.2.151:43450](2077):


00000000  00 00 08 00 45 00 00 54  3d e1 40 00 40 01 a0 9c  |....E..T=.@.@...|
00000010  ac 10 02 01 ac 10 02 0a  08 00 bf bc 07 5a 00 01  |.............Z..|
00000020  6a c4 cb 5d 00 00 00 00  3a f3 01 00 00 00 00 00  |j..]....:.......|
00000030  10 11 12 13 14 15 16 17  18 19 1a 1b 1c 1d 1e 1f  |................|
00000040  20 21 22 23 24 25 26 27  28 29 2a 2b 2c 2d 2e 2f  | !"#$%&'()*+,-./|
00000050  30 31 32 33 34 35 36 37  00 00 00 00 00 00 00 00  |01234567........|
00000060  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
*
00000220  00 00 00 00 00 00 00 00  a0 c2 b1 3d 52 7f 00 00  |...........=R...|
00000230  00 04 00 00 00 00 00 00  56 f5 7d 3d 52 7f 00 00  |........V.}=R...|
00000240  0b 00 00 00 00 00 00 00  03 00 00 00 00 00 00 00  |................|
00000250  01 00 00 00 00 00 00 00  80 21 00 00 e9 03 00 00  |.........!......|
00000260  05 00 00 00 00 00 00 00  00 88 00 00 00 00 00 00  |................|
00000270  00 00 00 00 00 00 00 00  00 04 00 00 00 00 00 00  |................|
00000280  00 00 00 00 00 00 00 00  5a c4 cb 5d 00 00 00 00  |........Z..]....|
00000290  21 38 82 2c 00 00 00 00  59 c4 cb 5d 00 00 00 00  |!8.,....Y..]....|
000002a0  21 38 82 2c 00 00 00 00  08 b4 cb 5d 00 00 00 00  |!8.,.......]....|
000002b0  c5 cb 79 18 00 00 00 00  23 a4 7e 3d 52 7f 00 00  |..y.....#.~=R...|
000002c0  00 00 00 00 00 00 00 00  a0 c2 b1 3d 52 7f 00 00  |...........=R...|
000002d0  1c 00 00 00 00 00 00 00  00 e0 d3 3d 52 7f 00 00  |...........=R...|
000002e0  00 00 00 00 00 00 00 00  e3 9a 7e 3d 52 7f 00 00  |..........~=R...|
000002f0  1c 00 00 00 00 00 00 00  a0 c2 b1 3d 52 7f 00 00  |...........=R...|
00000300  6b 18 40 00 00 00 00 00  55 b2 7e 3d 52 7f 00 00  |k.@.....U.~=R...|
00000310  0e 00 00 00 00 00 00 00  51 a9 7e 3d 52 7f 00 00  |........Q.~=R...|
00000320  a0 c2 b1 3d 52 7f 00 00  90 bc ba 00 fc 7f 00 00  |...=R...........|
00000330  51 18 40 00 00 00 00 00  5d 18 40 00 00 00 00 00  |Q.@.....].@.....|
00000340  00 00 00 00 00 00 00 00  69 ff 7b 3d 52 7f 00 00  |........i.{=R...|
00000350  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000360  20 b8 ba 00 fc 7f 00 00  00 00 00 00 00 00 00 00  | ...............|
00000370  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|

root@VM1:/mnt/partage# ./test_iftun tun0 172.16.2.156 123
Création de tun0
Tunnel tun0 créée 
Faire la configuration de tun0...
Appuyez sur une touche pour continuer

Interface tun0 Configurée:
Appuyez sur une touche pour terminer

le n° de la socket est : 4
Essai de connexion à 172.16.2.156 (172.16.2.156) sur le port 123

root@VM1-6:/mnt/partage# ./test_iftun 123
Ecoute sur le port 123
le n° de la socket est : 3
Option(s) OK!
bind!
listen!

root@VM1:/mnt/partage# gcc -c iftun.c
root@VM1:/mnt/partage# gcc -c extremite.c
root@VM1:/mnt/partage# gcc iftun.o extremite.o -o test_iftun

root@VM1:/mnt/partage# ./test_iftun tun0 | hexdump -C

00000000  00 00 08 00 45 00 00 54  bc a3 40 00 40 01 21 da  |....E..T..@.@.!.|
00000010  ac 10 02 01 ac 10 02 0a  08 00 d5 f9 08 f1 00 01  |................|
00000020  e8 19 bf 5d 00 00 00 00  b0 c9 02 00 00 00 00 00  |...]............|
00000030  10 11 12 13 14 15 16 17  18 19 1a 1b 1c 1d 1e 1f  |................|
00000040  20 21 22 23 24 25 26 27  28 29 2a 2b 2c 2d 2e 2f  | !"#$%&'()*+,-./|
00000050  30 31 32 33 34 35 36 37  63 0c 40 00 00 00 00 00  |01234567c.@.....|
00000060  00 00 00 00 00 00 00 00  1c 00 00 00 00 00 00 00  |................|
00000070  73 0c 40 00 00 00 00 00  00 00 00 00 00 00 00 00  |s.@.............|
00000080  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
*
000000b0  00 00 00 00 00 00 00 00  08 00 00 00 30 00 00 00  |............0...|
000000c0  60 80 1f 60 fc 7f 00 00  a0 7f 1f 60 fc 7f 00 00  |`..`.......`....|
000000d0  50 48 96 3b 19 7f 00 00  a0 32 ca 3b 19 7f 00 00  |PH.;.....2.;....|
000000e0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
*
000002f0  00 00 00 00 00 00 00 00  4c 0e cb 3b 19 7f 00 00  |........L..;....|
00000300  00 00 00 00 00 00 00 00  ca 96 93 1c 00 00 00 00  |................|
00000310  01 00 00 00 00 00 00 00  03 00 00 00 00 00 00 00  |................|
00000320  00 00 00 00 00 00 00 00  00 00 00 04 00 00 00 00  |................|
00000330  e0 20 93 3b 19 7f 00 00  00 00 00 00 00 00 00 00  |. .;............|
00000340  78 dd 90 3b 19 7f 00 00  f8 02 40 00 00 00 00 00  |x..;......@.....|
00000350  00 00 00 00 01 00 00 00  39 05 00 00 01 00 00 00  |........9.......|
00000360  01 00 00 00 00 00 00 00  10 7a ec 3b 19 7f 00 00  |.........z.;....|
00000370  c0 7f 1f 60 fc 7f 00 00  08 a5 ec 3b 19 7f 00 00  |...`.......;....|
00000380  e8 7f 1f 60 fc 7f 00 00  b0 a1 ec 3b 19 7f 00 00  |...`.......;....|
00000390  01 00 00 00 00 00 00 00  6d 19 cb 3b 19 7f 00 00  |........m..;....|
000003a0  00 00 00 00 00 00 00 00  10 7a ec 3b 19 7f 00 00  |.........z.;....|
000003b0  01 00 00 00 fc 7f 00 00  10 7a ec 3b 19 7f 00 00  |.........z.;....|
000003c0  00 00 00 00 00 00 00 00  00 00 00 04 00 00 00 00  |................|
000003d0  e0 20 93 3b 19 7f 00 00  00 00 00 00 00 00 00 00  |. .;............|
000003e0  78 dd 90 3b 19 7f 00 00  f8 02 40 00 00 00 00 00  |x..;......@.....|
000003f0  00 00 00 00 01 00 00 00  39 05 00 00 01 00 00 00  |........9.......|
00000400  01 00 00 00 00 00 00 00  10 7a ec 3b 19 7f 00 00  |.........z.;....|
00000410  c0 7f 1f 60 fc 7f 00 00  08 a5 ec 3b 19 7f 00 00  |...`.......;....|
00000420  e8 7f 1f 60 fc 7f 00 00  b0 a1 ec 3b 19 7f 00 00  |...`.......;....|
00000430  01 00 00 00 00 00 00 00  6d 19 cb 3b 19 7f 00 00  |........m..;....|
00000440  00 00 00 00 00 00 00 00  10 7a ec 3b 19 7f 00 00  |.........z.;....|
00000450  01 00 00 00 fc 7f 00 00  00 00 00 00 00 00 00 00  |................|
00000460  01 00 00 00 00 00 00 00  ff e1 93 3b 19 7f 00 00  |...........;....|
00000470  ff ff ff ff 00 00 00 00  10 7f 1f 60 ee 08 00 00  |...........`....|
00000480  d0 e3 93 3b 19 7f 00 00  dc 7e 1f 60 fc 7f 00 00  |...;.....~.`....|
00000490  00 00 00 00 00 00 00 00  08 a5 ec 3b 19 7f 00 00  |...........;....|
000004a0  00 00 00 00 fc 7f 00 00  20 7f 1f 60 fc 7f 00 00  |........ ..`....|
000004b0  8a e4 ee 1c 00 00 00 00  64 04 40 00 00 00 00 00  |........d.@.....|
000004c0  00 00 00 00 00 00 00 00  76 04 40 00 00 00 00 00  |........v.@.....|
000004d0  80 8a 90 3b 19 7f 00 00  c0 74 ec 3b 19 7f 00 00  |...;.....t.;....|
000004e0  00 00 00 00 01 00 00 00  00 00 00 00 00 00 00 00  |................|
000004f0  c0 07 40 00 00 00 00 00  60 81 1f 60 fc 7f 00 00  |..@.....`..`....|
00000500  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000510  80 80 1f 60 fc 7f 00 00  89 dd 94 3b 19 7f 00 00  |...`.......;....|
00000520  05 00 00 00 00 00 00 00  10 00 00 00 30 00 00 00  |............0...|
00000530  60 80 1f 60 fc 7f 00 00  a0 7f 1f 60 fc 7f 00 00  |`..`.......`....|
00000540  01 00 00 00 00 00 00 00  00 00 01 00 00 00 00 00  |................|
00000550  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
